#!/bin/bash

set -o errexit
set -o pipefail
set -o nounset

if [ -f /tmp/private.zip ]
then
    echo -n "Enter the private archive to retrieve with SCP: "
    read private_path

    scp "${private_path}" /tmp/private.zip
    unzip /tmp/private.zip -d /tmp

    # ssh keys
    mv /tmp/private/ssh/* ~/.ssh

    # private aliases
    mv /tmp/private/bash/bash_aliases.local ~/.bash_aliases.local

    # private git config
    mv /tmp/private/git/gitconfig.local ~/.gitconfig.local

    # private hosts
    cat /etc/hosts > hosts.bak
    echo "" >> hosts.bak
    cat /tmp/private/hosts/hosts >> hosts.bak
    sudo cp /etc/hosts "/etc/hosts.$(date +%Y%m%d)"
    sudo mv hosts.bak /etc/hosts
    sudo chown root:root /etc/hosts
    sudo chmod 644 /etc/hosts

    rm /tmp/private.zip
    rm -r /tmp/private
fi

exit 1

if [ ! -d "/home/${USER}/dotfiles" ]
then
    echo "Directory ~/dotfiles does not exist." 
    exit 1
fi

# configure bash
if [ ! -e "/home/${USER}/.bash_aliases" ]
then
    ln -s ~/dotfiles/bash/bash_aliases ~/.bash_aliases
    ln -s ~/dotfiles/bash/bash_functions ~/.bash_functions
    source ~/.bash_aliases
fi

# configure vim
if [ ! -e "/home/${USER}/.vimrc" ]
then
    mkdir -p ~/.vim/bundle
    ln -s ~/dotfiles/vim/vimrc ~/.vimrc
    git clone https://github.com/VundleVim/Vundle.vim.git ~/.vim/bundle/Vundle.vim
    vim +PluginInstall +qall
fi

# configure terminator
if [ ! -d "/home/${USER}/.config/terminator" ]
then
    mkdir -p ~/.config/terminator
    ln -s ~/dotfiles/terminator/config ~/.config/terminator/config
fi
